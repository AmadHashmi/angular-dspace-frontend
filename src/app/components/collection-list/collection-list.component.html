<div class="container">
  <div class="header">
    <div class="breadcrumb">
      <span class="breadcrumb-item" (click)="goBack()">Communities</span>
      @if (community) {
      <span class="breadcrumb-separator">/</span>
      <span class="breadcrumb-item active">{{
        community.name || "Untitled Community"
      }}</span>
      }
    </div>
    <h2>Collections</h2>
    @if (community) {
    <p class="community-name">
      in {{ community.name || "Untitled Community" }}
    </p>
    }
  </div>

  @if (loading) {
  <div class="loading">
    <p>Loading collections...</p>
  </div>
  } @else if (error) {
  <div class="error">
    <p>{{ error }}</p>
    <button (click)="retry()" class="retry-btn">Retry</button>
  </div>
  } @else if (collections.length === 0) {
  <div class="empty-state">
    <p>No collections found in this community.</p>
    <button (click)="retry()" class="retry-btn">Refresh</button>
  </div>
  } @else {
  <div class="grid">
    @for (collection of collections; track collection.uuid) {
    <div class="card" (click)="goToItemsList(collection)">
      <div class="card-header">
        <h3>{{ collection.name || "Untitled Collection" }}</h3>
      </div>
      <div class="card-body">
        <p class="handle">Handle: {{ collection["handle"] || "N/A" }}</p>
        <p class="items-count">
          Items:
          {{
            collection["archivedItemsCount"] >= 0
              ? collection["archivedItemsCount"]
              : "N/A"
          }}
        </p>
        @if (collection['metadata']?.['dc.description']?.[0]?.value) {
        <p class="description">
          {{ collection["metadata"]["dc.description"][0].value }}
        </p>
        }
      </div>
    </div>
    }
  </div>

  <app-pagination
    [pagination]="pagination"
    [currentPage]="currentPage"
    [pageSize]="pageSize"
    [loading]="loading"
    [entityType]="'collections'"
    (pageChange)="onPageChange($event)"
    (pageSizeChange)="onPageSizeChange($event)"
  >
  </app-pagination>
  }
</div>
